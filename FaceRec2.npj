{
    "scene_array": [
        {
            "data": "{\n    \"connections\": [\n        {\n            \"in_id\": \"{7da527eb-0bbc-4303-bd9b-4f9143f7bcb3}\",\n            \"in_index\": 0,\n            \"out_id\": \"{2273d78d-179e-419e-ab7c-3b4073d105d0}\",\n            \"out_index\": 0\n        },\n        {\n            \"in_id\": \"{2273d78d-179e-419e-ab7c-3b4073d105d0}\",\n            \"in_index\": 0,\n            \"out_id\": \"{45738172-754b-4352-8d51-c871696e97ba}\",\n            \"out_index\": 0\n        },\n        {\n            \"in_id\": \"{4f593948-b686-4f0d-9591-cb3f240a49ea}\",\n            \"in_index\": 0,\n            \"out_id\": \"{45738172-754b-4352-8d51-c871696e97ba}\",\n            \"out_index\": 0\n        },\n        {\n            \"in_id\": \"{45738172-754b-4352-8d51-c871696e97ba}\",\n            \"in_index\": 0,\n            \"out_id\": \"{28c1b4fd-38bb-4348-942f-fee55ea800df}\",\n            \"out_index\": 0\n        },\n        {\n            \"in_id\": \"{5c4c3ed0-aa82-44a1-a864-a1367bb9c0ae}\",\n            \"in_index\": 0,\n            \"out_id\": \"{2273d78d-179e-419e-ab7c-3b4073d105d0}\",\n            \"out_index\": 0\n        },\n        {\n            \"in_id\": \"{d8a76cab-a06e-4899-97aa-a01701993e8c}\",\n            \"in_index\": 0,\n            \"out_id\": \"{28c1b4fd-38bb-4348-942f-fee55ea800df}\",\n            \"out_index\": 0\n        },\n        {\n            \"in_id\": \"{e8e2c547-1818-4b26-a870-26b609ec8b27}\",\n            \"in_index\": 0,\n            \"out_id\": \"{7da527eb-0bbc-4303-bd9b-4f9143f7bcb3}\",\n            \"out_index\": 0\n        },\n        {\n            \"in_id\": \"{dcae3adb-02fb-4fd1-9e80-b2a81f1ef5d8}\",\n            \"in_index\": 0,\n            \"out_id\": \"{7da527eb-0bbc-4303-bd9b-4f9143f7bcb3}\",\n            \"out_index\": 0\n        },\n        {\n            \"in_id\": \"{7e1ad314-4073-4e52-b2b0-328acee31af4}\",\n            \"in_index\": 0,\n            \"out_id\": \"{e8e2c547-1818-4b26-a870-26b609ec8b27}\",\n            \"out_index\": 0\n        },\n        {\n            \"in_id\": \"{e4f8f390-34af-443c-af21-8caa35c64eb9}\",\n            \"in_index\": 0,\n            \"out_id\": \"{e8e2c547-1818-4b26-a870-26b609ec8b27}\",\n            \"out_index\": 0\n        }\n    ],\n    \"nodes\": [\n        {\n            \"id\": \"{91de4804-01b3-4768-b8b1-21bdaed8ca18}\",\n            \"model\": {\n                \"data\": {\n                    \"line_msg_secret\": \"09159a0061f6780764ea36ed8ca57a79\",\n                    \"line_msg_token\": \"Evp0ZPCuz5HFU0fOP2z1hZVX6EJfwanSOSEctvWVikn0alTwP13CnyV/QFh7L1w7w9SXsLqGlL5mz3QQrUZFvf9We9aq8MiqRfUQqbpcqLpMPqTuH1bm+rkexDn9u+SSzil6mwRwTWWx95O3En6+8AdB04t89/1O/w1cDnyilFU=\",\n                    \"ngrok_auth_token\": \"2W4wBWg9oQBOBf370Foy7EaQTfp_56CkDfjkpYPRpAvVEbCs5\",\n                    \"ngrok_local_port\": 3000,\n                    \"ngrok_region\": \"jp\",\n                    \"python_path\": \"C:/Users/66622/AppData/Local/Programs/Python/Python310/python.exe\",\n                    \"ros_service_name\": \"line\",\n                    \"working_dir\": \"C:/Users/66622/Downloads/CiRA-20230919T185655Z-001/CiRA\"\n                },\n                \"height\": 52,\n                \"name\": \"LineBot\",\n                \"node_enable\": true,\n                \"width\": 75\n            },\n            \"ngo\": {\n                \"comment\": {\n                    \"data\": \"\",\n                    \"show\": false\n                }\n            },\n            \"position\": {\n                \"fix\": false,\n                \"x\": -327.21929553718985,\n                \"y\": 293.21109272727284\n            }\n        },\n        {\n            \"id\": \"{5c4c3ed0-aa82-44a1-a864-a1367bb9c0ae}\",\n            \"model\": {\n                \"height\": 346,\n                \"name\": \"Debug\",\n                \"output_h\": 0,\n                \"output_v\": 0,\n                \"page_index\": 2,\n                \"payload_h\": 0,\n                \"payload_v\": 0,\n                \"width\": 242\n            },\n            \"ngo\": {\n                \"comment\": {\n                    \"data\": \"\",\n                    \"show\": false\n                }\n            },\n            \"position\": {\n                \"fix\": false,\n                \"x\": 164.86303473478597,\n                \"y\": 17.939717591284875\n            }\n        },\n        {\n            \"id\": \"{28c1b4fd-38bb-4348-942f-fee55ea800df}\",\n            \"model\": {\n                \"data\": {\n                    \"resp_timeout\": 30000,\n                    \"service_name\": \"line\"\n                },\n                \"name\": \"RosServer\",\n                \"node_enable\": true\n            },\n            \"ngo\": {\n                \"comment\": {\n                    \"data\": \"\",\n                    \"show\": false\n                }\n            },\n            \"position\": {\n                \"fix\": false,\n                \"x\": -588.8503200000001,\n                \"y\": -219.52321999999998\n            }\n        },\n        {\n            \"id\": \"{7e1ad314-4073-4e52-b2b0-328acee31af4}\",\n            \"model\": {\n                \"data\": {\n                    \"jpg\": true,\n                    \"png\": false,\n                    \"send_img\": true\n                },\n                \"name\": \"RosResponse\",\n                \"node_enable\": true\n            },\n            \"ngo\": {\n                \"comment\": {\n                    \"data\": \"\",\n                    \"show\": false\n                }\n            },\n            \"position\": {\n                \"fix\": false,\n                \"x\": 643.8341721487601,\n                \"y\": -133.6542215702479\n            }\n        },\n        {\n            \"id\": \"{d8a76cab-a06e-4899-97aa-a01701993e8c}\",\n            \"model\": {\n                \"height\": 267,\n                \"name\": \"Debug\",\n                \"output_h\": 0,\n                \"output_v\": 0,\n                \"page_index\": 2,\n                \"payload_h\": 0,\n                \"payload_v\": 0,\n                \"width\": 184\n            },\n            \"ngo\": {\n                \"comment\": {\n                    \"data\": \"\",\n                    \"show\": false\n                }\n            },\n            \"position\": {\n                \"fix\": false,\n                \"x\": -493.152973966942,\n                \"y\": -59.18626575206608\n            }\n        },\n        {\n            \"id\": \"{2273d78d-179e-419e-ab7c-3b4073d105d0}\",\n            \"model\": {\n                \"data\": {\n                    \"console\": \"\",\n                    \"js_code\": \"if (payload.FaceRec.face_array && payload.FaceRec.face_array.length > 0) {\\n  var objs = payload.FaceRec.face_array;\\n\\n  for (var i = 0; i < objs.length; i++) {\\n    for (var j = 0; j < objs.length - 1; j++) {\\n      if (objs[j].x > objs[j + 1].x) {\\n        // Swap\\n        var tmp = objs[j];\\n        objs[j] = objs[j + 1];\\n        objs[j + 1] = tmp;\\n      }\\n    }\\n  }\\n} else {\\n  // Handle the case when payload.FaceRec.face_array is empty or undefined\\n  // No console.log here\\n}\",\n                    \"widget_state\": {\n                        \"auto_indent\": true,\n                        \"auto_parent\": true,\n                        \"size\": 11,\n                        \"style\": \"Dracula\",\n                        \"widget_st_w\": 0,\n                        \"word_wrap\": false\n                    }\n                },\n                \"name\": \"JavaScript\",\n                \"node_enable\": true\n            },\n            \"ngo\": {\n                \"comment\": {\n                    \"data\": \"\",\n                    \"show\": false\n                }\n            },\n            \"position\": {\n                \"fix\": false,\n                \"x\": 19.90664661157018,\n                \"y\": -127.17803371900825\n            }\n        },\n        {\n            \"id\": \"{7da527eb-0bbc-4303-bd9b-4f9143f7bcb3}\",\n            \"model\": {\n                \"data\": {\n                    \"console\": \"\",\n                    \"js_code\": \"var objs = payload.FaceRec.face_array;\\nvar datetime = payload.datetimetFaceRec;\\nvar num = '';\\nvar hasUnknown = false;\\n\\nfor (var i = 0; i < objs.length; i++) {\\n\\tnum += objs[i].name;\\n\\tif (objs[i].name === \\\"UNKNOWN\\\") {\\n\\t\\thasUnknown = true;\\n\\t}\\n}\\n\\nif (hasUnknown) {\\n\\tpayload.ResultFaceRec = \\\"Check-in / Check-out: ระบบไม่พบใบหน้าในฐานข้อมูล\\\";\\n} else if (datetime !== undefined) {\\n\\tpayload.ResultFaceRec = \\\"Check-in / Check-out: ระบบทำการบันทึกคุณ \\\" + num + \\\" เข้าสู่ระบบเรียบร้อย เมื่อ \\\" + datetime + \\\".\\\";\\n} else if (num === '') {\\n\\tpayload.ResultFaceRec = \\\"Check-in / Check-out: ไม่พบใบหน้า กรุณาลองใหม่อีกครั้ง.\\\";\\n} else {\\n\\tvar currentDate = new Date();\\n\\tvar formattedDate = currentDate.toLocaleString();\\n\\tpayload.ResultFaceRec = \\\"Check-in / Check-out: ระบบทำการบันทึกคุณ \\\" + num + \\\" เข้าสู่ระบบเรียบร้อย เมื่อ \\\" + formattedDate + \\\".\\\";\\n}\",\n                    \"widget_state\": {\n                        \"editor_setting\": {\n                            \"autoComplete\": {\n                                \"caseSensitivity\": true,\n                                \"enable\": false,\n                                \"threshold\": 3\n                            },\n                            \"indent\": {\n                                \"enable\": true\n                            },\n                            \"theme\": \"Material Dark\",\n                            \"whitespace\": {\n                                \"enable\": false,\n                                \"size\": 2\n                            }\n                        }\n                    }\n                },\n                \"name\": \"JavaScript\",\n                \"node_enable\": true\n            },\n            \"ngo\": {\n                \"comment\": {\n                    \"data\": \"\",\n                    \"show\": false\n                }\n            },\n            \"position\": {\n                \"fix\": false,\n                \"x\": 172.59078355371895,\n                \"y\": -127.83854909090911\n            }\n        },\n        {\n            \"id\": \"{dcae3adb-02fb-4fd1-9e80-b2a81f1ef5d8}\",\n            \"model\": {\n                \"height\": 357,\n                \"name\": \"Debug\",\n                \"output_h\": 0,\n                \"output_v\": 0,\n                \"page_index\": 2,\n                \"payload_h\": 13,\n                \"payload_v\": 0,\n                \"width\": 251\n            },\n            \"ngo\": {\n                \"comment\": {\n                    \"data\": \"\",\n                    \"show\": false\n                }\n            },\n            \"position\": {\n                \"fix\": false,\n                \"x\": 591.696177206611,\n                \"y\": 9.433568677686054\n            }\n        },\n        {\n            \"id\": \"{e8e2c547-1818-4b26-a870-26b609ec8b27}\",\n            \"model\": {\n                \"data\": {\n                    \"console\": \"\",\n                    \"js_code\": \"var result = payload.ResultFaceRec;\\npayload.line_msg = result;\\n\",\n                    \"widget_state\": {\n                        \"editor_setting\": {\n                            \"autoComplete\": {\n                                \"caseSensitivity\": true,\n                                \"enable\": false,\n                                \"threshold\": 3\n                            },\n                            \"indent\": {\n                                \"enable\": true\n                            },\n                            \"theme\": \"Material Dark\",\n                            \"whitespace\": {\n                                \"enable\": false,\n                                \"size\": 2\n                            }\n                        }\n                    }\n                },\n                \"name\": \"JavaScript\",\n                \"node_enable\": true\n            },\n            \"ngo\": {\n                \"comment\": {\n                    \"data\": \"\",\n                    \"show\": false\n                }\n            },\n            \"position\": {\n                \"fix\": false,\n                \"x\": 465.1221791735537,\n                \"y\": -131.81268487603302\n            }\n        },\n        {\n            \"id\": \"{f94f8626-369f-4f0c-91bd-e4b04977df4b}\",\n            \"model\": {\n                \"data\": {\n                },\n                \"name\": \"FaceTrainer\",\n                \"node_enable\": true\n            },\n            \"ngo\": {\n                \"comment\": {\n                    \"data\": \"\",\n                    \"show\": false\n                }\n            },\n            \"position\": {\n                \"fix\": false,\n                \"x\": -478.1757900000001,\n                \"y\": 295.44049000000007\n            }\n        },\n        {\n            \"id\": \"{45738172-754b-4352-8d51-c871696e97ba}\",\n            \"model\": {\n                \"data\": {\n                    \"face_only\": false,\n                    \"font_scale\": 5,\n                    \"font_thickness\": 10,\n                    \"max_distance\": 25,\n                    \"rect_thickness\": 5,\n                    \"result_drawing\": true,\n                    \"show_distance\": true,\n                    \"text_drawing\": true,\n                    \"thresh\": 90,\n                    \"txt_offset\": 1\n                },\n                \"name\": \"FaceRec\",\n                \"node_enable\": true\n            },\n            \"ngo\": {\n                \"comment\": {\n                    \"data\": \"\",\n                    \"show\": false\n                }\n            },\n            \"position\": {\n                \"fix\": false,\n                \"x\": -416.72171000000003,\n                \"y\": -220.69473000000005\n            }\n        },\n        {\n            \"id\": \"{4f593948-b686-4f0d-9591-cb3f240a49ea}\",\n            \"model\": {\n                \"height\": 264,\n                \"name\": \"Debug\",\n                \"output_h\": 0,\n                \"output_v\": 0,\n                \"page_index\": 0,\n                \"payload_h\": 17,\n                \"payload_v\": 0,\n                \"width\": 264\n            },\n            \"ngo\": {\n                \"comment\": {\n                    \"data\": \"\",\n                    \"show\": false\n                }\n            },\n            \"position\": {\n                \"fix\": false,\n                \"x\": -176.12331740646164,\n                \"y\": -509.12738620886506\n            }\n        },\n        {\n            \"id\": \"{e4f8f390-34af-443c-af21-8caa35c64eb9}\",\n            \"model\": {\n                \"data\": {\n                    \"comment\": \"\",\n                    \"py_ver\": \"2. Python310\",\n                    \"script\": \"import pygsheets\\nimport datetime\\n\\n# Authorize and open the Google Sheet\\ngc = pygsheets.authorize(service_file='cirasheet002.json')\\nsheet = gc.open_by_key(\\\"1dqQ7B9-h4A2LkxntL7rjmdetHUOLDTPmEA4iWWR_sLE\\\")\\nworksheet = sheet[0]\\n\\n# Get all the existing data in the worksheet\\ncells = worksheet.get_all_values(include_tailing_empty_rows=False, include_tailing_empty=False, returnas='matrix')\\nlast_row = len(cells)\\n\\n# Get the current date and time\\ndd = datetime.datetime.now()\\n\\n# Sample payload data (you need to have this in your actual code)\\n# payload = ...\\n\\n# Result array from payload\\nResult = payload[\\\"FaceRec\\\"][\\\"face_array\\\"]\\n\\n# Loop through each object in the result array\\nfor objs in Result:\\n\\tif objs[\\\"name\\\"] != \\\"UNKNOWN\\\":\\n\\t\\t# Create the data list with the required information\\n\\t\\tdata = [dd.strftime('%Y-%m-%d'), dd.strftime('%H:%M:%S'), objs[\\\"name\\\"]]\\n\\t\\t\\n\\t\\t# Insert the data into the worksheet\\n\\t\\tworksheet.insert_rows(last_row, number=1, values=data, inherit=True)\\n\\t\\t\\n\\t\\t# Update the last_row counter\\n\\t\\tlast_row += 1\\n\",\n                    \"tmp_path\": \"C:/Users/66622\",\n                    \"widget_state\": {\n                        \"editor_setting\": {\n                            \"autoComplete\": {\n                                \"caseSensitivity\": true,\n                                \"enable\": true,\n                                \"threshold\": 3\n                            },\n                            \"indent\": {\n                                \"enable\": true\n                            },\n                            \"theme\": \"Material Dark\",\n                            \"whitespace\": {\n                                \"enable\": false,\n                                \"size\": 2\n                            }\n                        },\n                        \"splt0\": 15,\n                        \"splt1\": 10\n                    }\n                },\n                \"height\": 47,\n                \"name\": \"PythonScript\",\n                \"node_enable\": true,\n                \"python_code\": \"import pygsheets\\nimport datetime\\n\\n# Authorize and open the Google Sheet\\ngc = pygsheets.authorize(service_file='cirasheet002.json')\\nsheet = gc.open_by_key(\\\"1dqQ7B9-h4A2LkxntL7rjmdetHUOLDTPmEA4iWWR_sLE\\\")\\nworksheet = sheet[0]\\n\\n# Get all the existing data in the worksheet\\ncells = worksheet.get_all_values(include_tailing_empty_rows=False, include_tailing_empty=False, returnas='matrix')\\nlast_row = len(cells)\\n\\n# Get the current date and time\\ndd = datetime.datetime.now()\\n\\n# Sample payload data (you need to have this in your actual code)\\n# payload = ...\\n\\n# Result array from payload\\nResult = payload[\\\"FaceRec\\\"][\\\"face_array\\\"]\\n\\n# Loop through each object in the result array\\nfor objs in Result:\\n\\tif objs[\\\"name\\\"] != \\\"UNKNOWN\\\":\\n\\t\\t# Create the data list with the required information\\n\\t\\tdata = [dd.strftime('%Y-%m-%d'), dd.strftime('%H:%M:%S'), objs[\\\"name\\\"]]\\n\\t\\t\\n\\t\\t# Insert the data into the worksheet\\n\\t\\tworksheet.insert_rows(last_row, number=1, values=data, inherit=True)\\n\\t\\t\\n\\t\\t# Update the last_row counter\\n\\t\\tlast_row += 1\\n\",\n                \"width\": 75\n            },\n            \"ngo\": {\n                \"comment\": {\n                    \"data\": \"\",\n                    \"show\": false\n                }\n            },\n            \"position\": {\n                \"fix\": false,\n                \"x\": 626.1750000000002,\n                \"y\": -340.25199999999995\n            }\n        }\n    ],\n    \"scene_data\": {\n        \"flow_view_fix\": false,\n        \"flow_view_pos_x\": -261.7833598614553,\n        \"flow_view_pos_y\": -213.9768022191186,\n        \"flow_view_zoom_factor\": 0.42409761837248483\n    }\n}\n",
            "name": "Main"
        }
    ]
}
